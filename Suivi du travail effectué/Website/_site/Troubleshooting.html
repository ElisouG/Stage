<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Troubleshooting</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />




<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4,h5",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Génotypage du bar</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Bioinfo
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="tools-used.html">Outils utilisés</a>
    </li>
    <li>
      <a href="tools_description.html">Description des outils</a>
    </li>
    <li>
      <a href="tuto.html">Tutoriaux suivis</a>
    </li>
    <li>
      <a href="Troubleshooting.html">Troubleshooting</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Manip'
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="LaboSemaine1.html">Semaine 1</a>
    </li>
    <li>
      <a href="LaboSemaine2.html">Semaine 2</a>
    </li>
    <li>
      <a href="LaboSemaine3.html">Semaine 3</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Réunions
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="premiereReunion_2702.html">Réunion du 27/02/2018</a>
    </li>
    <li>
      <a href="deuxiemeReunion_1403.html">Réunion du 14/03/2018</a>
    </li>
    <li>
      <a href="troisiemeReunion_0304.html">Réunion du 03/04/2018</a>
    </li>
    <li>
      <a href="quatriemeReunion_0604.html">Réunion du 06/04/2018</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Séminaires
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Seminaires_CNRS.html">Séminaires CNRS</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-newspaper-o"></span>
     
    Biblio
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Seabass.html">Dicentrarchus labax</a>
    </li>
    <li>
      <a href="sequencing_methods.html">Méthodes de séquençage</a>
    </li>
    <li>
      <a href="SNP_annotation.html">Annotation des SNPs</a>
    </li>
    <li>
      <a href="statisticSNP.html">Analyse statistiques des SNPs</a>
    </li>
    <li>
      <a href="GWAS_Stress_Fish.html">GWAS Stress Fish</a>
    </li>
    <li>
      <a href="genome_annotation.html">Annotation d'un génome</a>
    </li>
    <li>
      <a href="ManagingAffyData.html">Managing Affymetrix Data</a>
    </li>
    <li>
      <a href="pipeline_tools.html">Pipeline tools</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="about.html">
    <span class="fa fa-info"></span>
     
    About
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Troubleshooting</h1>

</div>


<hr />
<div id="using-snpeff" class="section level1">
<h1>Using snpEff</h1>
<p>snpEff est utilisé pour déterminer les effets des SNPs déposés sur le puce Affymetrix qui sera utilisée dans le cadre de la recherche des SNPs liés à la réponse au stress de <em>Dicentrarchus labrax</em>. Comme cette espèce est très peu étudiée (pas disponible dans la plupart des base de données existantes), il faut construire une base de données à partir d’un fichier d’annotation du génome de <em>Dicentrarchus labrax</em>. Ensuite, il est possible d’analyser les effects des SNPs (au format VCF). Pour cela il faut lancer l’analyse. Lors du lacement de cette analyse différents problèmes sont apparus (All definitions are from <a href="http://snpeff.sourceforge.net/SnpEff_manual.html">SnpEff manual</a> website) :</p>
<ul>
<li><p>WARNING_TRANSCRIPT_INCOMPLETE : A protein coding transcript having a non-multiple of 3 length. It indicates that the reference genome has missing information about this particular transcript.</p></li>
<li><p>WARNING_TRANSCRIPT_MULTIPLE_STOP_CODONS : A protein coding transcript has two or more STOP codons in the middle of the coding sequence (CDS). This should not happen and it usually means the reference genome may have an error in this transcript.</p></li>
<li><p>WARNING_TRANSCRIPT_NO_START_CODON : A protein coding transcript does not have a proper START codon. It is rare that a real transcript does not have a START codon, so this probably indicates an error or missing information in the reference genome.</p></li>
<li><p>WARNING_TRANSCRIPT_NO_STOP_CODON</p></li>
</ul>
<p>Pour résoudre ces “warnings” provenant finalement d’un problème d’annotation du génome de <em>Dicentrarchus Labrax</em>, je crée un script en langage <a href="https://www.python.org/">Python</a> pour récupérer ces erreurs (“warnings”) pour les corriger au sein du fichier d’annotation.</p>
</div>
<div id="using-gatk-and-wdl" class="section level1">
<h1>Using GATK and wdl</h1>
<p>Pour le moment GATK est utilisé dans le but de trouver des SNPs à partir de fichiers Bam issus du Projet CRECHE de 2016. C’est fichiers BAM ont été obtenus par séquençage.</p>
<p>Le séquençage a été réalisé en paired-end 2x150bp. Les données ont été nettoyées avec trimmomatic et alignées sur le génome avec TopHat2. La suite a été faite avec <a href="http://cole-trapnell-lab.github.io/cufflinks/">cufflinks</a> puis <a href="http://software.broadinstitute.org/cancer/software/genepattern/modules/docs/Cuffmerge/3">cuffmerge</a>. Tout cela a été effectué en suivant l’ordre alphanumérique des chromosomes, aussi bien dans le fichier d’annotation de référence utilisé : Combined-annotation_Labrax-2014_Ordered.gtf que dans le fichier fasta du génome. Cela donne donc : LG10 à LG19 puis LG1A, LG1B, LG2, LG20, LG22-25, LG24, puis LG3 à LG9, LGx, MT et enfin UN.</p>
<p>Pour commencer je me suis référée au <a href="https://software.broadinstitute.org/gatk/documentation/article?id=4067">Bonnes Pratiques pour utiliser GATK lorsque l’on fait du RNA-seq</a>. J’ai donc ensuite écrit plusieurs scripts en m’aidant des différents tutoriels disponibles <a href="https://software.broadinstitute.org/wdl/documentation/topic?name=wdl-tutorials">ici</a>.</p>
<p>Le premier me permet de préprocesser les données afin d’obtenir des données prêtes à être processées. Ce script s’appelle : “Data_PreProcessing.wdl”. Lorsque je lance ce script sur le cluster différentes erreurs sont apparues. Le première erreur est un défaut d’ordre entre le fichier fasta et les fichiers bam. Pour résoudre ce problème, j’ai donc écrit un nouveau script afin de réordrer les reads des fichiers bam en fonction du fichier fasta à ma disposition. D’autre part, dans les Bonnes Pratiques pour utiliser GATK lorsque l’on fait du RNA-seq, il recommande d’utiliser l’outil d’alignement nommé <em>BWA</em> avec <em>l’algorithme mem</em> et <em>l’option -M</em> pour être compatible avec la suite d’outil de GATK et notamment l’outil Picard et l’option <em>MarkDuplicates</em>. L’option -M permet de faire l’alignement des splices-jonctions en second pour que les données soient compatibles avec MarkDuplicates. Pour plus de détails voir <a href="http://bio-bwa.sourceforge.net/bwa.shtml">ici</a>. Or <a href="">TopHat2</a> est un aligneur de short-reads qui réalise aussi une anlyse de splice-jonctions. Je me suis alors demandée si GATK et TopHat2 étaient compatibles.</p>
<p>Hors en vérifiant c’est bien le cas. TopHat2 donne les niveau de qualité de 255 qui sont considérés par GATK comme des niveau de qualité null et les reads ayant cette qualité sont ignorés. Cf : <a href="https://software.broadinstitute.org/gatk/documentation/tooldocs/3.8-0/org_broadinstitute_gatk_engine_filters_ReassignOneMappingQualityFilter.php" class="uri">https://software.broadinstitute.org/gatk/documentation/tooldocs/3.8-0/org_broadinstitute_gatk_engine_filters_ReassignOneMappingQualityFilter.php</a>. Donc j’ai lancé un changement de cette qualité mais pour ce faire il faut utiliser GATK3.8.0 et non GATK4.0.3.0. Sauf qu’ensuite un nouveau problème est apparu : L’ordre des chromosomes n’est pas le même dans le bam et dans le fasta. Donc j’ai dû ajouté une nouvelle étape qui va réordrer les reads en fonction des contigs du fichier fasta. Cf : <a href="https://software.broadinstitute.org/gatk/documentation/article.php?id=1328" class="uri">https://software.broadinstitute.org/gatk/documentation/article.php?id=1328</a>. J’ai donc créé un second script nommé “ReassignOneMappingQualityFilter.wdl” qui réalise ces deux étapes.</p>
<p>Le troisième script nommé “Data_Processing.wdl” me permet de processer mes données pour qu’elles soient ensuite analysables. Ciomme le VQSR n’est pas disponible pour les données de RNA-seq (Cf : Les Bonnes Pratiques pour utiliser GATK lorsque l’on fait du RNA-seq). Il me faut réaliser un hardfiltering. Mais comment choisir ces filtres ? POur cela, 3 sites m’ont aidés. Le <a href="https://software.broadinstitute.org/gatk/documentation/article.php?id=1255">premier</a> pour comprendre le fonctionnement des JEXL (Java EXpression Language) pour l’écriture des filtres, le <a href="https://software.broadinstitute.org/gatk/documentation/article.php?id=3225">second</a> pour et le <a href="https://software.broadinstitute.org/gatk/documentation/article.php?id=6925">dernier</a> pour.</p>
</div>

<p>Copyright &copy; 2018 | Elise GUERET</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
